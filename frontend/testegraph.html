<html>
	<head>
		<title>teste</title>

		<script type="text/javascript" src="ajax/prototype.js"></script>
		<script type="text/javascript" src="classes/Clube.js"></script>
		<script type="text/javascript" src="classes/Local.js"></script>
		<script type="text/javascript" src="classes/Tempo.js"></script>
		<script type="text/javascript" src="classes/Noticia.js"></script>
		<script src="highcharts/js/adapters/prototype-adapter.js" type="text/javascript"></script>
		<script src="highcharts/js/highcharts.js" type="text/javascript"></script>

		<script type="text/javascript" charset="utf-8">
			var chart1;

			function drawFrutas() {

				var options = {
					chart : {
						renderTo : 'caixa',
						defaultSeriesType : 'bar'
					}
				};

				// title
				options.title = new Object();
				options.title.text = 'Fruit Consumption 10';

				// x
				options.xAxis = new Object();
				options.xAxis.categories = new Array('Apples', 'Bananas', 'Oranges');

				// y
				options.yAxis = new Object();
				options.yAxis.title = '# Fruit eaten';

				// data
				options.series = new Array();
				options.series.push({
					name : 'Jáne bla',
					data : [1, 0, 4]
				});
				options.series.push({
					name : 'John blabla í',
					data : [5, 7, 3]
				});

				chart1 = new Highcharts.Chart(options);
				/*
				 chart1 = new Highcharts.Chart({
				 chart : {
				 renderTo : 'caixa',
				 type : 'bar'
				 },
				 title : {
				 text : 'Fruit Consumption'
				 },
				 xAxis : {
				 categories : ['Apples', 'Bananas', 'Oranges']
				 },
				 yAxis : {
				 title : {
				 text : 'Fruit eaten'
				 }
				 },
				 series : [{
				 name : 'Jane',
				 data : [1, 0, 4]
				 }, {
				 name : 'John',
				 data : [5, 7, 3]
				 }]
				 });*/
			}

			function inTop10(valor, top) {
				min_id = 0;
				min_val = 999999999;

				if(top.length < 10) {
					top.push({
						nome : valor.nome,
						val : valor.val
					});
					//alert(valor.nome + '\n' + valor.val);
				} else {
					for( i = 0; i < top.length; i++) {
						if(top[i].val < min_val) {
							min_id = i;
							min_val = top[i].val;
						}
					}

					if(valor.val > min_val) {
						top[min_id] = {
							nome : valor.nome,
							val : valor.val
						};
					}
				}

				return (top);
			}

			function getNomeArray(nomeCount) {
				var nomes = Array();

				for(var i=0; i<nomeCount.length; i++){
					nomes[i] = nomeCount[i].nome;
				}
				return (nomes);
			}

			function getValArray(nomeCount) {
				var counts = Array();

				for(var i=0; i<nomeCount.length; i++){
					counts[i] = nomeCount[i].val;
				}
				return (counts);
			}

			function drawClubes() {

				var clubes = new Array();
				var clube = new Clube();
				clube.getAllClubes(0,0,function(result) {
					clubes = result;
				});

				var top10 = new Array();
				var nome_count = new Array();

				// contar noticias
				for( i = 0; i < clubes.length; i++) {
					clube.getClubeCountNoticias(clubes[i].idclube, function(result) {
						top10 = inTop10({
							nome : clubes[i].nome_oficial,
							val : result
						}, top10);
					});
				}

				// desenhar grafico

				var options = {
					chart : {
						renderTo : 'caixa',
						defaultSeriesType : 'bar'
					}
				};
			
				// title
				options.title = new Object();
				options.title.text = 'Top 10 clubes com mais notícias';

				// x
				options.xAxis = new Object();
				options.xAxis.title = 'Clube'
				options.xAxis.categories = new Array();
				options.xAxis.categories = getNomeArray(top10);

				// y
				options.yAxis = new Object();
				options.yAxis.title = '# notícias';

				// data
				options.series = new Array();
				options.series[0] = new Object();
				options.series[0].name = '# Notícias';
				options.series[0].data = new Array();
				options.series[0].data = getValArray(top10);
				
				chart1 = new Highcharts.Chart(options);
			}

			function drawLocais() {

				var locais = new Array();
				var local = new Local();
				local.getAllLocais(0,0,function(result) {
					locais = result;
				});

				var top10 = new Array();
				var nome_count = new Array();

				// contar noticias
				for( i = 0; i < locais.length; i++) {
					local.getLocalCountNoticias(locais[i].idlocal, function(result) {
						top10 = inTop10({
							nome : locais[i].nome_local,
							val : result
						}, top10);
					});
				}

				// desenhar grafico

				var options = {
					chart : {
						renderTo : 'caixa',
						defaultSeriesType : 'bar'
					}
				};
			
				// title
				options.title = new Object();
				options.title.text = 'Top 10 locais com mais notícias';

				// x
				options.xAxis = new Object();
				options.xAxis.title = 'Local'
				options.xAxis.categories = new Array();
				options.xAxis.categories = getNomeArray(top10);

				// y
				options.yAxis = new Object();
				options.yAxis.title = '# notícias';

				// data
				options.series = new Array();
				options.series[0] = new Object();
				options.series[0].name = '# Notícias';
				options.series[0].data = new Array();
				options.series[0].data = getValArray(top10);
				
				chart1 = new Highcharts.Chart(options);
			}

		</script>
	</head>

	<body>

		<div id="caixa" style="width: 100%; height: 400px"></div>
		<input type="button" onclick="drawFrutas()" value="Frutas" />
		<input type="button" onclick="drawClubes()" value="Clubes" />
		<input type="button" onclick="drawLocais()" value="Locais" />
	</body>
</html>